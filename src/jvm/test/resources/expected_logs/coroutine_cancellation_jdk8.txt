= Invalid execution results =
| ---------------------------------------------------- |
|     Thread 1     |             Thread 2              |
| ---------------------------------------------------- |
| isAbsurd(): true | cancelledOp() + cancel: CANCELLED |
| ---------------------------------------------------- |

The following interleaving leads to the error:
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|                                                         Thread 1                                                         |                                                                        Thread 2                                                                        |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| isAbsurd(): true                                                                                                         |                                                                                                                                                        |
|   correct.READ: true at CoroutineCancellationTraceReportingTest.isAbsurd(CoroutineCancellationTraceReportingTest.kt:35)  |                                                                                                                                                        |
|   switch                                                                                                                 |                                                                                                                                                        |
|                                                                                                                          | cancelledOp() + cancel: CANCELLED                                                                                                                      |
|                                                                                                                          |   <cont>.initCancellability() at CoroutineCancellationTraceReportingTest.cancelledOp(CoroutineCancellationTraceReportingTest.kt:54)                    |
|                                                                                                                          |   <cont>.invokeOnCancellation(cancelledOp$2$1#7) at CoroutineCancellationTraceReportingTest.cancelledOp(CoroutineCancellationTraceReportingTest.kt:28) |
|                                                                                                                          |   <cont>.getResult(): COROUTINE_SUSPENDED at CoroutineCancellationTraceReportingTest.cancelledOp(CoroutineCancellationTraceReportingTest.kt:56)        |
|                                                                                                                          |     trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                    |
|                                                                                                                          |     getParentHandle(): ChildContinuation#5 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                |
|                                                                                                                          |   CANCELLED BEFORE RESUMPTION                                                                                                                          |
|                                                                                                                          |   _state.get(): InvokeOnCancel#8 at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:0)                                               |
|                                                                                                                          |   _state.compareAndSet(InvokeOnCancel#8,CancelledContinuation#9): true at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:209)       |
|                                                                                                                          |   <cont>.callCancelHandler(InvokeOnCancel#8,Exception#10) at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:212)                    |
|                                                                                                                          |   <cont>.detachChildIfNonResuable() at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:216)                                          |
|                                                                                                                          |   <cont>.dispatchResume(1) at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:217)                                                   |
|                                                                                                                          |   result: CANCELLED                                                                                                                                    |
|   correct.READ: false at CoroutineCancellationTraceReportingTest.isAbsurd(CoroutineCancellationTraceReportingTest.kt:35) |                                                                                                                                                        |
|   result: true                                                                                                           |                                                                                                                                                        |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |

Detailed trace:
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
|                                                         Thread 1                                                         |                                                                                        Thread 2                                                                                         |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| isAbsurd(): true                                                                                                         |                                                                                                                                                                                         |
|   correct.READ: true at CoroutineCancellationTraceReportingTest.isAbsurd(CoroutineCancellationTraceReportingTest.kt:35)  |                                                                                                                                                                                         |
|   switch                                                                                                                 |                                                                                                                                                                                         |
|                                                                                                                          | cancelledOp() + cancel: CANCELLED                                                                                                                                                       |
|                                                                                                                          |   <cont>.initCancellability() at CoroutineCancellationTraceReportingTest.cancelledOp(CoroutineCancellationTraceReportingTest.kt:54)                                                     |
|                                                                                                                          |     installParentHandle(): ChildContinuation#5 at CancellableContinuationImpl.initCancellability(CancellableContinuationImpl.kt:129)                                                    |
|                                                                                                                          |       _parentHandle.compareAndSet(null,ChildContinuation#5): true at CancellableContinuationImpl.installParentHandle(CancellableContinuationImpl.kt:352)                                |
|                                                                                                                          |     isCompleted(): false at CancellableContinuationImpl.initCancellability(CancellableContinuationImpl.kt:134)                                                                          |
|                                                                                                                          |       getState$kotlinx_coroutines_core(): Active#6 at CancellableContinuationImpl.isCompleted(CancellableContinuationImpl.kt:112)                                                       |
|                                                                                                                          |         _state.get(): Active#6 at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                                      |
|                                                                                                                          |   <cont>.invokeOnCancellation(cancelledOp$2$1#7) at CoroutineCancellationTraceReportingTest.cancelledOp(CoroutineCancellationTraceReportingTest.kt:28)                                  |
|                                                                                                                          |     invokeOnCancellationImpl(InvokeOnCancel#8) at CancellableContinuationImpl.invokeOnCancellation(CancellableContinuationImpl.kt:399)                                                  |
|                                                                                                                          |       _state.get(): Active#6 at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:403)                                                                |
|                                                                                                                          |       _state.compareAndSet(Active#6,InvokeOnCancel#8): true at CancellableContinuationImpl.invokeOnCancellationImpl(CancellableContinuationImpl.kt:407)                                 |
|                                                                                                                          |   <cont>.getResult(): COROUTINE_SUSPENDED at CoroutineCancellationTraceReportingTest.cancelledOp(CoroutineCancellationTraceReportingTest.kt:56)                                         |
|                                                                                                                          |     trySuspend(): true at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:300)                                                                                     |
|                                                                                                                          |       _decisionAndIndex.get(): 536870911 at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:0)                                                                    |
|                                                                                                                          |       _decisionAndIndex.compareAndSet(536870911,1073741823): true at CancellableContinuationImpl.trySuspend(CancellableContinuationImpl.kt:278)                                         |
|                                                                                                                          |     getParentHandle(): ChildContinuation#5 at CancellableContinuationImpl.getResult(CancellableContinuationImpl.kt:310)                                                                 |
|                                                                                                                          |       _parentHandle.get(): ChildContinuation#5 at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                       |
|                                                                                                                          |   CANCELLED BEFORE RESUMPTION                                                                                                                                                           |
|                                                                                                                          |   _state.get(): InvokeOnCancel#8 at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:0)                                                                                |
|                                                                                                                          |   _state.compareAndSet(InvokeOnCancel#8,CancelledContinuation#9): true at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:209)                                        |
|                                                                                                                          |   <cont>.callCancelHandler(InvokeOnCancel#8,Exception#10) at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:212)                                                     |
|                                                                                                                          |     InvokeOnCancel#8.invoke(Exception#10) at CancellableContinuationImpl.callCancelHandler(CancellableContinuationImpl.kt:249)                                                          |
|                                                                                                                          |       cancelledOp$2$1#7.invoke(Exception#10): Unit at InvokeOnCancel.invoke(CancellableContinuationImpl.kt:642)                                                                         |
|                                                                                                                          |         invoke(Exception#10) at CoroutineCancellationTraceReportingTest$cancelledOp$2$1.invoke(CoroutineCancellationTraceReportingTest.kt:28)                                           |
|                                                                                                                          |           CoroutineCancellationTraceReportingTest#11.setCorrect(false) at CoroutineCancellationTraceReportingTest$cancelledOp$2$1.invoke(CoroutineCancellationTraceReportingTest.kt:29) |
|                                                                                                                          |             correct.WRITE(false) at CoroutineCancellationTraceReportingTest.setCorrect(CoroutineCancellationTraceReportingTest.kt:22)                                                   |
|                                                                                                                          |   <cont>.detachChildIfNonResuable() at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:216)                                                                           |
|                                                                                                                          |     detachChild$kotlinx_coroutines_core() at CancellableContinuationImpl.detachChildIfNonResuable(CancellableContinuationImpl.kt:565)                                                   |
|                                                                                                                          |       getParentHandle(): ChildContinuation#5 at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:572)                                     |
|                                                                                                                          |         _parentHandle.get(): ChildContinuation#5 at CancellableContinuationImpl.getParentHandle(CancellableContinuationImpl.kt:106)                                                     |
|                                                                                                                          |       _parentHandle.set(NonDisposableHandle#12) at CancellableContinuationImpl.detachChild$kotlinx_coroutines_core(CancellableContinuationImpl.kt:574)                                  |
|                                                                                                                          |   <cont>.dispatchResume(1) at CancellableContinuationImpl.cancel(CancellableContinuationImpl.kt:217)                                                                                    |
|                                                                                                                          |     tryResume(): false at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:472)                                                                                |
|                                                                                                                          |       _decisionAndIndex.get(): 1073741823 at CancellableContinuationImpl.tryResume(CancellableContinuationImpl.kt:0)                                                                    |
|                                                                                                                          |     DispatchedTaskKt.dispatch(<cont>,1) at CancellableContinuationImpl.dispatchResume(CancellableContinuationImpl.kt:474)                                                               |
|                                                                                                                          |       DispatchedTaskKt.resume(<cont>,<cont>,false) at DispatchedTaskKt.dispatch(DispatchedTask.kt:168)                                                                                  |
|                                                                                                                          |         <cont>.takeState$kotlinx_coroutines_core(): CancelledContinuation#9 at DispatchedTaskKt.resume(DispatchedTask.kt:174)                                                           |
|                                                                                                                          |           getState$kotlinx_coroutines_core(): CancelledContinuation#9 at CancellableContinuationImpl.takeState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:168)              |
|                                                                                                                          |             _state.get(): CancelledContinuation#9 at CancellableContinuationImpl.getState$kotlinx_coroutines_core(CancellableContinuationImpl.kt:108)                                   |
|                                                                                                                          |   result: CANCELLED                                                                                                                                                                     |
|   correct.READ: false at CoroutineCancellationTraceReportingTest.isAbsurd(CoroutineCancellationTraceReportingTest.kt:35) |                                                                                                                                                                                         |
|   result: true                                                                                                           |                                                                                                                                                                                         |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
